    ctrl nop
    ctrl addi R1 ZERO 150           # R1 = 320*240
    ctrl sll R1 R1
    ctrl sll R1 R1
    ctrl sll R1 R1
    ctrl sll R1 R1
    ctrl sll R1 R1
    ctrl sll R1 R1
    ctrl sll R1 R1
    ctrl sll R1 R1
    ctrl sll R1 R1

    ctrl addi VADDR ZERO 0          # VADDR = 0

    node addi R2 ZERO 56
    node swap R2 R2

    ctrl addi DMA ZERO 0
    ctrl dma set_read_active
    ctrl nop

    ctrl addi DMA ZERO 1
    ctrl dma set_write_active
    ctrl nop

    ctrl addi DMA ZERO 4
    ctrl dma set_write_base_addr    # write base addr = 4
    ctrl nop

    ctrl addi DMA ZERO 160
    ctrl sll DMA DMA
    ctrl dma set_write_vertical_incr
    ctrl nop

    ctrl addi R4 ZERO 160           # R4 = 320
    ctrl sll R4 R4
    ctrl add DMA ZERO R4        	# DMA = R4 * 3 + 1 = 640 + 320 + 1
    ctrl add DMA DMA R4
    ctrl add DMA DMA R4
    ctrl addi DMA DMA 1
    ctrl dma set_write_horizontal_incr
    ctrl nop

    ctrl dma start
    ctrl nop

    ctrl nop
    ctrl nop
    ctrl nop
    ctrl nop
    ctrl nop

    ctrl nop
    ctrl nop
    ctrl nop
    ctrl nop
    ctrl nop

    ctrl nop
    ctrl nop
    ctrl nop
    ctrl nop
    ctrl nop

    ctrl nop
    ctrl nop
    ctrl nop
    ctrl nop
    ctrl nop

    ctrl nop
    ctrl nop
    ctrl nop
    ctrl nop
    ctrl nop

pixel_loop:

    ctrl lw VDATA VADDR
    ctrl nop
    ctrl addi VADDR VADDR 1

    ctrl beq infinite_loop
    ctrl slt ZERO R1 VADDR
    ctrl nop

    ctrl jump pixel_loop

infinite_loop:

    ctrl nop
    ctrl jump infinite_loop
